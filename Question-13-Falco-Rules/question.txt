Weight: 9%
Domain: Monitoring, Logging and Runtime Security (20%)

Context:
A security incident has been reported. The cluster admin suspects that a malicious actor
has spawned shells inside running containers. You need to use Falco to detect and
investigate this behavior.

Task:
1. Falco is installed on node 'node01'. SSH to this node.
   All the following steps must be performed on node01.

2. Create a custom Falco rule file at /etc/falco/rules.d/shell-detect.yaml that:
   - Detects when shell processes (bash, sh, ash, dash, zsh) are spawned inside containers
   - Uses appropriate macros for process spawning and container detection
   - Rule name: 'Shell Spawned in Container'
   - Output must include: user, command, container name, pod name, and namespace
   - Priority: WARNING

3. Restart Falco service and verify it's running

4. Trigger the rule by executing a shell in any running pod

5. Check Falco logs for the alert

6. Identify the container ID where the shell was spawned
   Save the container ID to: /opt/course/13/container-id.txt (on node01)

7. Save the Falco alert output to: /opt/course/13/falco-alert.txt (on node01)

